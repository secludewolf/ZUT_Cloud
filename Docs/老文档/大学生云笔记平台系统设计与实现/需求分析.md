# 1、概述

## 1.1 项目背景

目前，大多数网盘应用停止运营或者出现高收费的情况，大量的学生想使用云盘分享和存储一些数据变得非常的困难，对于学生来说网盘费用是个问题，对于教师来说，给学生分享一些文件资料也非常不方便，下载下载限速等。因此，私有云盘应用而生，本系统能够为软件学院的学生提供数据存储和共享服务，使教师能够轻松为学生分享软件、课件、视频等资料，学生亦能够使用云盘来存储个人的其他文件数据。

## 1.2 项目介绍

本系统主要有三级用户，功能分别是：

1、系统管理员：主要用于用户认证审核，系统公告，数据存储，集群监控

2、学生用户：提供注册、登录云盘系统，上传、下载、分享云盘内容。

3、教师端用户：提供注册、登录云盘系统，群组管理，通知管理，群聊功能等。

按照软件工程规范描述管理员端需求，细化用例规约，合理设计数据库，实现管理员端以下功能：

1.	用户认证：学生实名认证与教师认证，学生注册后必须实名认证通过方能使用云盘，非实名认证人员无法使用云盘的存储服务，但是可以下载其他用户分享的云盘内容。教师认证后才能使用创建群组的功能。
2.	系统公告：系统公告主要是系统管理员发布一些云盘公告通知，比如违规用户处理公告等信息
3.	数据存储：需要实现数据存储平台的构建与设计，提供数据存储的服务接口开发。
4.	集群监控：实现集群数据的监控报告，比如空间使用情况，数据异常监控、违规数据清理等服务。

按照软件工程规范描述学生端需求，细化用例规约，合理设计数据库，实现管理员端以下功能：

1.	登录注册：提供注册和登录入口，注册成功后进入到实名认证页面，实名认证成功后方可进入云盘首页界面，登录成功后亦进入云盘首页。
2.	数据管理：主要是目录管理，文件上传【要实现秒传功能】与下载，文件搜索等功能。
3.	分享管理：用于创建云盘内容的分享，可以设置打开密码，设置分享有效期，提供取消分享入口，查看已分享内容。

按照软件工程规范描述教师端需求，细化用例规约，合理设计数据库，实现管理员端以下功能：

1.	注册登录：注册后需要进行实名认证，认证通过后与普通的学生用户功能一致，通过个人信息中的教师认证接口进入教师认证页面提交认证信息，认证状态分为：未认证、认证中、认证通过
2.	群组管理：教师用户可以创建群组，在群组内可以直接分享云盘内容，发布群组公告，添加群组成员，提供一键导入群组成员功能，提供群聊功能

本系统有三个角色，功能分别是：
游客：浏览、下载无权限限制的分享文件
用户：上传文件、下载文件、分享文件、在线预览文件等
管理员：数据统计、文件审核、通知管理、集群状态管理等
按照软件工程规范描述项目需求，细化用例规约，合理设计数据库，实现项目以下功能
游客或普通用户功能：

1. 账号管理
   注册：使用邮箱或手机号进行注册，注册时需要填写基本信息以及用于身份验证的信息，待管理员审核通过后方可用于登录。注册入口可由管理员控制是否开放注册。
   登录：使用邮箱或手机号进行登录，并且支持自动登录与长时间保持登录状态。
   注销：包含自动注销与手动注销。注销后注销后用户存储文件与分享全部失效、用户基本信息清空，账号给予保留，即逻辑删除。
   安全中心：用户通过注册时留下的邮箱或手机号进行重置密码。
   个人中心：对用户个人信息进行管理

2. 文件管理
   搜索：提供通过关键字搜索文件的功能，以及按文件类型分类浏览文件的功能。
   移动：移动选中文件到其他目录。
   重命名：判断是否存在重名文件并重命名。
   删除：删除文件至回收站。
   创建文件夹：判断是否存在重名文件并创建文件夹。
   回收站：恢复文件或彻底删除文件，回收站文件超出30天未处理将自动删除。

3. 上传/下载
   新文件上传：对于从未上传过的新文件将会采用分块上传、校验文件完整性并保存文件特征信息，然后创建文件信息。
   重复文件上传：若文件特征信息已存在，则直接创建文件信息并显示“秒传成功”。
   私有文件下载：检查用户身份并创建下载链接。
   分享文件下载：检查分享状态、判断用户权限，创建下载链接。

4.	文件分享
创建分享：可以选择创建分享的类型如加密或公开。
管理分享：支持修改分享密码，修改分享限制，删除分享。
查看分享：判断分享类型后，验证分享密码（如果是加密分享的话）后即可产看分享信息。
保存分享：支持保存分享内容选定部分到当前用户的指定目录下。
分享举报：分享被多次举报后将会被暂时限制访问，等待管理员审核处理。

5. 文件预览

   支持预览常见文本、音频、图片、视频文件。

6. 用户管理
   批量创建与删除用户：通过外部学生或教师的唯一特征信息批量创建与删除账号，免去管理员管理用户身份的麻烦或收回已经离校的学生或教师的账号。

7. 文件审核：管理员可以对服务器上的所有文件进行审核，被标记为敏感文件的文件特征信息相关联的所有文件、分享失效并禁止下载。并会通过系统公告的形式通知文件上传者，以示警告。

8. 通知管理
   系统公告主要是系统管理员发布一些云盘公告通知，比如违规用户处理公告等信息

9. 服务器监控
   实现集群数据的监控报告，比如空间使用情况，数据异常监控、违规数据清理等服务。

10. 容量管理
    为减轻服务器压力，教师用户默认容量为5T，学生用户默认容量为1T，教师用户可以申请增加容量，在符合条件的情况下可以给与增加。但最多为10T容量。

## 1.3 技术分析 -- 需要修改

WEB服务器：SpringBoot + MyBatis

关系数据库：MySQL（基础用户信息、权限信息）

非关系数据库：Elasticsearch（用户文件信息、分享信息）

内存数据库：Redis（Token信息，缓冲数据库数据）

文件存储服务器：HDFS

文件缓冲服务器：Ngnix+fastDFS

Hadoop状态监控：Ambari

前端网页：VUE+Axios+Element UI+Echarts

# 2、需求分析

## 2.1 功能需求

### 2.1.1 功能划分

功能在主要分为以下几类：

1. 用户管理功能
2. 文件管理功能
3. 文件分享功能
4. 群组管理功能
5. 系统公告功能
6. 服务器监控功能

### 2.1.2 功能描述

#### 2.1.2.1 用户管理功能

1. 注册
2. 登陆
3. 修改密码：通过旧密码修改密码
4. 忘记密码
    1. 联系方式找回密码
        1. 邮箱找回密码：通过向用户的邮箱发送验证码重置密码
        2. 手机找回密码：通过向用户的手机发送验证码重置消息
    2. 申请重置密码：如果用户没有设置联系方式的话，可以向管理员发送重置密码申请。
5. 账号注销
6. 用户信息管理
    1. 增加用户
    2. 删除用户
    3. 修改用户
        1. 基础信息修改
        2. 标签信息修改
    4. 查找用户
        1. 查看用户信息
        2. 筛选查找用户信息
7. 标签管理（标签代指一般的role角色）
    1. 申请标签：向标签创建人申请获得标签
    2. 认证标签：标签创建者同意申请者获得此标签
    3. 创建标签：创建一个新的标签
    4. 删除标签：删除一个所拥有的的标签
    5. 查看标签：查看所拥有的标签
    6. 修改标签：修改标签的权限

#### 2.1.2.2 文件管理功能

1. 上传文件
    1. 上传单文件
    2. 上传文件夹
2. 下载文件
    1. 下载单文件
    2. 下载文件夹
    3. 预览文件
3. 查找文件
    1. 显示我的文件：我上传和保存的文件
    2. 显示我有权下载的文件：如我所在群组的文件
    3. 显示回收站中的文件：被移动到回收站，但是还未删除的文件
    4. 筛选查找
        1. 文件类型查找
        2. 文件标签查找
        3. 文件权限查找
        4. 自定义查找
4. 移入回收站
5. 删除文件
    1. 删除单文件
    2. 删除文件夹
    3. 清空回收站
6. 移动文件
    1. 移动单文件
    2. 移动文件夹
7. 创建文件夹
8. 文件重命名

#### 2.1.2.3 文件分享功能

1. 分享文件
    1. 通过链接分享文件：打开链接即可获得文件
    2. 通过标签分享文件：类似于群组分享，拥有此标签的均可获得文件
2. 删除分享
3. 查看分享

#### 2.1.2.4 群组聊天功能

1. 添加好友
2. 删除好友
3. 创建群聊
4. 解散群聊
5. 群聊添加用户
6. 群聊移除用户
7. 发送消息
8. 接收消息

#### 2.1.2.5 系统公告功能

1. 发布通知
2. 接收通知

#### 2.1.2.6 服务器监控功能

1. 监控服务器状态

## 2.2 性能需求 **

## 2.3 运行需求 **

## 2.4 其他需求 **

# 3、系统概要设计

## 3.1 总体设计 ** 

## 3.2 模块划分 -- 待定

1. 用户模块
2. 管理员模块
3. 服务器维护模块

## 3.3 系统分析 -- 待定

### 3.3.1 参与者

1. 管理员
2. 用户
3. 运维人员

### 3.3.2 用例及用例规约

#### 3.3.2.1 管理员

1. 账号管理
    1. 登陆
        1. 手机登陆
        2. 邮箱登录
        3. 账号登陆
    2. 退出
    3. 注册
        1. 手机号注册
            1. 手机验证
        2. 邮箱注册
            1. 邮箱验证
    4. 注销
    5. 修改密码
        1. 邮箱验证修改密码
            1. 邮箱验证
        2. 手机验证修改密码
            1. 手机验证
        3. 旧密码验证修改密码
    6. 找回密码
        1. 邮箱找回密码
            1. 邮箱验证
        2. 手机找回密码
            1. 手机验证
2. 管理员信息管理
    1. 查看管理员信息
        1. 查看信息
        2. 查看标签认证状态
    2. 修改管理员信息
        1. 修改基本信息
        2. 标签认证
3. 全局账号管理
    1. 管理员账号管理
        1. 查看管理员
            1. 查看所有管理员
            2. 查看条件筛选管理员
        2. 增加管理员
            1. 增加一个管理员
            2. 增加多个管理员
        3. 删除管理员
            1. 删除一个管理员
            2. 删除多个管理员
        4. 修改管理员
            1. 基础信息修改
            2. 标签信息修改
        5. 查找管理员
    2. 用户账号管理
        1. 查看用户
            1. 查看所有用户
            2. 查看条件筛选用户
        2. 增加用户
            1. 增加一个用户
            2. 增加多个用户
        3. 删除用户
            1. 删除一个用户
            2. 删除多个用户
        4. 修改用户
            1. 基础信息修改
            2. 标签信息修改
        5. 查找用户
4. 信息认证
    1. 管理员信息认证
        1. 管理员标签认证
    2. 用户信息认证
        1. 用户身份认证
        2. 用户标签认证
5. 文件管理
    1. 全局文件管理
        1. 查看文件
        2. 文件审核
        3. 文件删除
    2. 用户文件管理
        1. 文件分发（向指定用户仓库中添加文件）
            1. 单用户
            2. 多用户
            3. 条件筛选
        2. 公共仓库
            1. 上传文件
                1. 上传单文件
                2. 上传文件夹
            2. 下载文件
                1. 下载单文件
                2. 下载文件夹
                3. 预览文件
            3. 查找文件
                1. 文件类型查找
                2. 文件标签查找
                3. 文件权限查找
                4. 自定义查找
            4. 删除文件
6. 标签管理
    1. 认证标签
    2. 创建标签
    3. 删除标签
    4. 查看标签
    5. 修改标签
8. 通知管理
    1. 发布通知
        1. 发布管理员通知
            1. 筛选管理员通知
            2. 全局管理员通知
        2. 发布用户通知
            1. 筛选用户通知
            2. 全局用户通知
    2. 接收通知
    3. 标记通知已读
    4. 查看已发布的通知通知

#### 3.3.2.2 用户

1. 账号管理
    1. 登陆
        1. 手机登陆
        2. 邮箱登陆
        3. 账号登录
    2. 退出
    3. 注册
        1. 手机号注册
            1. 手机验证
        2. 邮箱注册
            1. 邮箱验证
    4. 注销
    5. 修改密码
        1. 邮箱验证修改密码
            1. 邮箱验证
        2. 手机验证修改密码
            1. 手机验证
        3. 旧密码验证修改密码
    6. 找回密码
        1. 邮箱找回密码
            1. 邮箱验证
        2. 手机找回密码
            1. 手机验证
2. 用户信息管理
    1. 查看用户信息
        1. 查看基础信息
        2. 查看身份认证信息
        3. 查看标签认证信息
    2. 修改用户信息
        1. 修改基础信息
        2. 身份认证
        3. 标签认证
3. 文件管理
    1. 上传文件
        1. 上传单文件
        2. 上传文件夹
    2. 下载文件
        1. 下载单文件
        2. 下载文件夹
        3. 预览文件
    3. 查找文件
        1. 显示仓库
        3. 显示回收站
        4. 筛选查找
            1. 文件类型查找
            2. 文件标签查找
            4. 自定义查找
    4. 移入回收站
    5. 删除文件
        1. 删除单文件
        2. 删除文件夹
        3. 清空回收站
    6. 移动文件
        1. 移动单文件
        2. 移动文件夹
    7. 创建文件夹
    8. 文件重命名
4. 文件分享管理
    1. 分享文件
        1. 加密分享
        2. 公开分享
        3. 群组分享
        4. 好友分享
    2. 删除分享
    3. 查看分享
5. 标签管理
    1. 申请标签
    2. 认证标签
    3. 创建标签
    4. 删除标签
    5. 查看标签
    6. 修改标签
7. 通知管理
    2. 接收通知
    2. 标记通知已读
8. 群聊管理
    1. 添加好友
    2. 删除好友
    3. 创建群聊
    4. 退出群聊
    5. 解散群聊
    6. 群聊添加用户
    7. 群聊移除用户
    8. 发送消息
    9. 接收消息

#### 3.3.2.3 运维人员

1. 账号管理
    1. 登陆
        1. 手机登陆
        2. 邮箱登陆
        3. 账号登录
    2. 退出
    3. 注册
        1. 手机号注册
            1. 手机验证
        2. 邮箱注册
            1. 邮箱验证
    4. 注销
    5. 修改密码
        1. 邮箱验证修改密码
            1. 邮箱验证
        2. 手机验证修改密码
            1. 手机验证
        3. 旧密码验证修改密码
    6. 找回密码
        1. 邮箱找回密码
            1. 邮箱验证
        2. 手机找回密码
            1. 手机验证
2. 查看服务器状态
    1. 查看服务器日志
    2. 查看服务器存储使用量
    3. 。。

### 3.3.3 用例图 **

## 3.4 系统设计 **

### 3.4.1 顺序图 **

### 3.4.2 类图 **

## 3.5 系统体系结构设计

参照数据库设计：[数据库设计](.\数据库设计.md)

## 3.6 接口设计 -- 未完成

参照接口文档：[接口文档](.\接口文档.md)

## 3.7 运行设计 **

## 3.8 系统数据结构设计 **

## 3.9 系统出错处理设计 **

# 4、系统详细设计 **

## 4.1 模块一 **

### 4.1.1 程序描述 **

### 4.1.2 功能 **

### 4.1.3 算法 **

### 4.1.4 流程逻辑 **

### 4.1.5 接口 **

### 4.1.6 限制条件 **

### 4.1.7 测试计划 **



# 5、 系统测试设计 **