## 分享功能

### 创建分享

~~~mermaid
graph TD
	start((开始))-->用户Token-->TokenID
	start-->数据
	数据-->用户ID
	数据-->Files
	数据-->Folders
	数据-->分享名称-->创建分享
	数据-->分享密码-->创建分享
	数据-->失效时间-->创建分享
   	TokenID-->j1{身份验证}
   	用户ID-->j1
   	j1--错误-->返回创建失败-->finish((结束))
   	j2--异常-->返回创建失败
   	Files-->j2{判断文件状态}--正常-->遍历添加文件依赖关系并重构文件路径-->创建分享
   	Folders-->j2{判断文件状态}
   	j1--成功-->创建分享-->返回分享信息-->finish
   	
   
   
   
   
~~~



### 删除分享

```mermaid
graph TD
   start((开始))
   finish((结束))
   token[用户Token]
   shareId[分享ID]
   userId[用户ID]
   shareInfo[分享信息]
   judge{判断分享是否属于当前用户}
   start --> token --> userId --> judge
   start --> shareId --> shareInfo --> judge
   dfl[移除文件依赖关系]
   ds[变更分享状态为失效]
   rs[返回删除成功]
   rf[返回删除失败]
   judge --正确--> j2{判断分享状态}--有效-->dfl --> ds --> rs --> finish
   j2--无效-->rs
   judge --错误--> rf --> finish
```

### 查看个人分享

```mermaid
graph TD
	start((开始))-->用户Token-->TokenID-->j{查询}--不存在-->返回用户不存在-->finish((结束))
	j--存在-->返回分享列表-->finish
```



### 查看他人分享

```mermaid
graph TD
	start((开始))-->用户Token-->TokenID-->j1{验证登录状态}--异常-->返回登录状态异常-->finish((结束))
	start-->数据-->分享ID-->j2{查询分享信息}--查询成功-->j5{判断分享状态}--有效-->j6{判断分享是否超出有效时间}--有效-->j3{判断是否有密码}--无密码-->更新分享信息-->返回分享信息-->finish((结束))
	j5--无效-->返回分享失效-->finish
	j6--无效-->更新分享状态-->返回分享失效
	数据-->分享密码-->j4{判断密码是否正确}--正确-->更新分享信息
	j3--有密码-->j4
	j4--错误-->返回密码错误-->finish
	j1--正常-->j2{查询分享信息}--查询失败-->返回分享不存在-->finish
```



### 保存他人分享

```mermaid
graph TD
	start((开始))-->用户Token-->TokenID
	start-->数据
	数据-->用户ID
	数据-->分享ID-->j2{查询分享信息}--查询失败-->返回保存失败-->finish
	j2--查询成功-->j3{判断分享状态}--失效-->返回保存失败
	j3--有效-->j4{判断分享是否超出有效时间}--超出时效-->更新分享状态-->返回保存失败
	j4--未超出时效-->j7{判断是否有密码}--有密码-->j5{验证密码}--密码错误-->返回密码错误-->finish
	j5--密码正确-->j6{是否存在重名文件}--有重名文件-->返回文件已存在-->finish
	j6--无重名文件-->保存文件-->更新分享信息-->返回仓库信息-->finish
	j7--无密码-->j6
	数据-->Files-->保存文件
	数据-->Folders-->保存文件
	数据-->保存位置-->保存文件
	数据-->分享密码-->j5
   	TokenID-->j1{身份验证}--成功-->j2
   	用户ID-->j1
   	j1--错误-->返回登陆状态异常-->finish((结束))
```



### 举报他人分享 TODO





### 下载分享 TODO

```mermaid
graph TD
start((开始))-->用户Token-->j1{验证登录状态}--异常-->返回登录状态异常-->finish((结束))
```





